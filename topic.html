<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Topics | Laugh Creators Studio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <div class="container">

    <header>
      <h1 id="topic-title">Loading...</h1>
      <p id="topic-date" style="color:#888;"></p>
    </header>

    <section id="topic-content"></section>

    <a href="index.html" class="button">← Topへ戻る</a>

  </div>

<script>
const API_KEY = "vKaatSkfGiIWO0m9gfz0uNv9qj0trrYeXq4W";
const SERVICE_ID = "laugh";
const ENDPOINT = "news";

const params = new URLSearchParams(location.search);
const id = params.get("id");

const titleEl = document.getElementById("topic-title");
const dateEl = document.getElementById("topic-date");
const contentEl = document.getElementById("topic-content");

if (!id) {
  titleEl.textContent = "記事が見つかりません";
} else {
  fetch(`https://${SERVICE_ID}.microcms.io/api/v1/${ENDPOINT}/${id}`, {
    headers: { "X-MICROCMS-API-KEY": API_KEY }
  })
  .then(res => {
    if (!res.ok) throw new Error(res.status);
    return res.json();
  })
  .then(data => {
    titleEl.textContent = data.title;
    dateEl.textContent = data.publishedAt.slice(0,10);
    contentEl.innerHTML = data.content;
  })
  .catch(err => {
    titleEl.textContent = "記事の読み込みに失敗しました";
    contentEl.textContent = "Error: " + err;
  });
}
</script>

</body>
</html>
